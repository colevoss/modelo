/*! modelo 27-10-2014 */
"use strict";var Base=function(){};Base.extend=function(a,b){var c=Base.prototype.extend;Base._prototyping=!0;var d=new this;c.call(d,a),d.base=function(){},delete Base._prototyping;var e=d.constructor,f=d.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor===f)this._constructing=!0,e.apply(this,arguments),delete this._constructing;else if(null!==arguments[0])return(arguments[0].extend||c).call(arguments[0],d)};return f.ancestor=this,f.extend=this.extend,f.forEach=this.forEach,f.implement=this.implement,f.prototype=d,f.toString=this.toString,f.valueOf=function(a){return"object"===a?f:e.valueOf()},c.call(f,b),"function"==typeof f.init&&f.init(),f},Base.prototype={extend:function(a,b){if(arguments.length>1){var c=this[a];if(c&&"function"==typeof b&&(!c.valueOf||c.valueOf()!==b.valueOf())&&/\bbase\b/.test(b)){var d=b.valueOf();b=function(){var a=this.base||Base.prototype.base;this.base=c;var b=d.apply(this,arguments);return this.base=a,b},b.valueOf=function(a){return"object"===a?b:d},b.toString=Base.toString}this[a]=b}else if(a){var e=Base.prototype.extend;Base._prototyping||"function"==typeof this||(e=this.extend||e);for(var f={toSource:null},g=["constructor","toString","valueOf"],h=Base._prototyping?0:1;h<g.length;h++){var i=g[h];a[i]!==f[i]&&e.call(this,i,a[i])}for(var j in a)f[j]||e.call(this,j,a[j])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(a,b,c){for(var d in a)void 0===this.prototype[d]&&b.call(c,a[d],d,a)},implement:function(){for(var a=0;a<arguments.length;a++)"function"==typeof arguments[a]?arguments[a](this.prototype):this.prototype.extend(arguments[a]);return this},toString:function(){return String(this.valueOf())}}),function(a,b,c){var d=b.extend({validation:{},beforeSet:c,afterSet:c,beforeGet:c,route:c,template:"",constructor:function(a){this._data={};for(var b in a)this._data[b]=a[b],this.defineProps(b)},defineProps:function(a){var b=this._data,c=this;Object.defineProperty(this,a,{get:function(){return c.beforeGet&&c.beforeGet({key:a,value:b[a],model:c}),b[a]},set:function(d){var e;return e=c.checkValidation(a,d),e.length?void 0:(c.beforeSet&&c.beforeSet({key:a,value:b[a],model:c}),b[a]=d,c.afterSet&&c.afterSet({key:a,value:b[a],model:c}),d)}})},checkValidation:function(a,b){if(!this.validations||"undefined"==typeof this.validations[a])return[];var c,d;d=[],c=this.validations[a];for(var e in c)switch(e){case"type":typeof b!==c[e]&&d.push({type:"type",error:""+b+" is not of type "+c[e],expected:c[e],received:typeof b});break;case"match":c[e].test(b)||d.push({type:"match",error:""+b+" does not match provided RegExp of "+c[e]})}return c.fail&&d.length&&c.fail(d),d},processRoute:function(){var a=this,b=this.route.replace(/:\w+(?=\/|$)/g,function(b){return a[b.substring(1)]});return b},renderTemplate:function(){var a=this.template;return""===a?!1:("function"==typeof a&&(a=a(this._data)),this._domMaker(a))},each:function(a){for(var b in this._data)a(b,this[b])},_domMaker:function(b){var c,d,e,f,g,h,i,j;c=new RegExp(/<[\w\s="'-]+>/),b.replace(c,""),d=b.match(c),j=d[0].match(/<(\w+)/)[1],e=d[0].replace(/<\w+[\s>]/,""),f=e.match(/[\w-]+(?:=['"][\w\s-]*["'])*/g),f||(f=[]),h=a.document.createElement(j);for(var k=0;k<f.length;k++)switch(g=f[k].split("="),g[0]){case"class":g.length>1&&(h.className=g[1].replace(/['"]/g,""));break;case"id":g.length>1&&(h.id=g[1].replace(/["']/g,""));break;default:h.setAttribute(g[0],g.length>1?g[1].replace(/['"]/g,""):"")}return b=b.replace(c,""),i=new RegExp("</"+h.tagName.toLocaleLowerCase()+">$"),b=b.replace(i,""),h.innerHTML=b,h}});d.VERSION="0.0.1",a.Modelo=d}(this,Base);